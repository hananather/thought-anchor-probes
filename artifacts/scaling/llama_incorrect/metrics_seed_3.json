{
  "cache_provenance": {
    "anchor_percentile": 90.0,
    "compute_dtype": "float16",
    "counterfactual_field": "counterfactual_importance_accuracy",
    "drop_last_chunk": true,
    "dtype": "float16",
    "embedding_layout": "sentence_mean",
    "layer_index": 16,
    "layer_mode": "mid",
    "model_dir": "deepseek-r1-distill-llama-8b",
    "model_name_or_path": "deepseek-ai/DeepSeek-R1-Distill-Llama-8B",
    "num_sentences": 3466,
    "pooling": "mean",
    "repo_id": "uzaymacar/math-rollouts",
    "requested_layer_index": null,
    "split_dir": "incorrect_base_solution",
    "temp_dir": "temperature_0.6_top_p_0.95",
    "total_tokens": 78677,
    "vertical_attention_depth_control": true,
    "vertical_attention_full_max_seq_len": 1024,
    "vertical_attention_light_last_n_tokens": 1,
    "vertical_attention_mode": "off"
  },
  "confidence_intervals": {
    "score_activations_plus_position_minus_score_position_baseline": {
      "ci_high": -0.01865949158228608,
      "ci_low": -0.11732144936870692,
      "delta_mean": -0.05384140290604367,
      "group_col": "problem_id",
      "n_bootstrap": 2000,
      "n_valid_bootstrap": 2000,
      "point_delta": -0.055538293875555644,
      "score_a": "score_activations_plus_position",
      "score_b": "score_position_baseline"
    },
    "score_activations_plus_position_minus_score_text_only_baseline": {
      "ci_high": 0.07139781889147502,
      "ci_low": -0.0004578307305707907,
      "delta_mean": 0.030421786892618197,
      "group_col": "problem_id",
      "n_bootstrap": 2000,
      "n_valid_bootstrap": 2000,
      "point_delta": 0.03383219268091324,
      "score_a": "score_activations_plus_position",
      "score_b": "score_text_only_baseline"
    }
  },
  "has_vertical_scores": false,
  "position_bin_metrics": {
    "num_bins": 5,
    "test": {
      "activations_plus_position": [
        {
          "bin_index": 0,
          "count": 137,
          "left_inclusive": 0.0,
          "pr_auc": 0.18234871658784102,
          "prevalence": 0.1678832116788321,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 135,
          "left_inclusive": 0.2,
          "pr_auc": 0.29430721818960937,
          "prevalence": 0.2074074074074074,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 136,
          "left_inclusive": 0.4,
          "pr_auc": 0.10194816607381892,
          "prevalence": 0.07352941176470588,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 135,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.026445567033082148,
          "prevalence": 0.037037037037037035,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 138,
          "left_inclusive": 0.8,
          "pr_auc": 0.028675070408801975,
          "prevalence": 0.028985507246376812,
          "right_inclusive": 1.0
        }
      ],
      "linear_probe": [
        {
          "bin_index": 0,
          "count": 137,
          "left_inclusive": 0.0,
          "pr_auc": 0.1905870889402833,
          "prevalence": 0.1678832116788321,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 135,
          "left_inclusive": 0.2,
          "pr_auc": 0.280368568838512,
          "prevalence": 0.2074074074074074,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 136,
          "left_inclusive": 0.4,
          "pr_auc": 0.0923136872972144,
          "prevalence": 0.07352941176470588,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 135,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.02542129734173504,
          "prevalence": 0.037037037037037035,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 138,
          "left_inclusive": 0.8,
          "pr_auc": 0.02469997140756069,
          "prevalence": 0.028985507246376812,
          "right_inclusive": 1.0
        }
      ],
      "mlp_probe": [
        {
          "bin_index": 0,
          "count": 137,
          "left_inclusive": 0.0,
          "pr_auc": 0.15967801879000104,
          "prevalence": 0.1678832116788321,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 135,
          "left_inclusive": 0.2,
          "pr_auc": 0.22571071399730147,
          "prevalence": 0.2074074074074074,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 136,
          "left_inclusive": 0.4,
          "pr_auc": 0.08615126609431357,
          "prevalence": 0.07352941176470588,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 135,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.03526661508569918,
          "prevalence": 0.037037037037037035,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 138,
          "left_inclusive": 0.8,
          "pr_auc": 0.03949873655756009,
          "prevalence": 0.028985507246376812,
          "right_inclusive": 1.0
        }
      ],
      "position_baseline": [
        {
          "bin_index": 0,
          "count": 137,
          "left_inclusive": 0.0,
          "pr_auc": 0.1827447184703843,
          "prevalence": 0.1678832116788321,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 135,
          "left_inclusive": 0.2,
          "pr_auc": 0.24071414496773072,
          "prevalence": 0.2074074074074074,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 136,
          "left_inclusive": 0.4,
          "pr_auc": 0.22009841241815079,
          "prevalence": 0.07352941176470588,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 135,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.06710060832141958,
          "prevalence": 0.037037037037037035,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 138,
          "left_inclusive": 0.8,
          "pr_auc": 0.08109990695803053,
          "prevalence": 0.028985507246376812,
          "right_inclusive": 1.0
        }
      ],
      "text_only_baseline": [
        {
          "bin_index": 0,
          "count": 137,
          "left_inclusive": 0.0,
          "pr_auc": 0.14591161689184373,
          "prevalence": 0.1678832116788321,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 135,
          "left_inclusive": 0.2,
          "pr_auc": 0.247036252547159,
          "prevalence": 0.2074074074074074,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 136,
          "left_inclusive": 0.4,
          "pr_auc": 0.05548644511117867,
          "prevalence": 0.07352941176470588,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 135,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.02618756802193335,
          "prevalence": 0.037037037037037035,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 138,
          "left_inclusive": 0.8,
          "pr_auc": 0.022481919470413968,
          "prevalence": 0.028985507246376812,
          "right_inclusive": 1.0
        }
      ]
    },
    "val": {
      "activations_plus_position": [
        {
          "bin_index": 0,
          "count": 89,
          "left_inclusive": 0.0,
          "pr_auc": 0.20560415687394837,
          "prevalence": 0.19101123595505617,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 88,
          "left_inclusive": 0.2,
          "pr_auc": 0.23001343234117988,
          "prevalence": 0.14772727272727273,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 87,
          "left_inclusive": 0.4,
          "pr_auc": 0.1261126471828544,
          "prevalence": 0.09195402298850575,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 88,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.15172319467598105,
          "prevalence": 0.056818181818181816,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 90,
          "left_inclusive": 0.8,
          "pr_auc": 0.041162280701754386,
          "prevalence": 0.022222222222222223,
          "right_inclusive": 1.0
        }
      ],
      "linear_probe": [
        {
          "bin_index": 0,
          "count": 89,
          "left_inclusive": 0.0,
          "pr_auc": 0.20687898901051388,
          "prevalence": 0.19101123595505617,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 88,
          "left_inclusive": 0.2,
          "pr_auc": 0.25226188692180546,
          "prevalence": 0.14772727272727273,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 87,
          "left_inclusive": 0.4,
          "pr_auc": 0.12190242027540894,
          "prevalence": 0.09195402298850575,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 88,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.16148107966202596,
          "prevalence": 0.056818181818181816,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 90,
          "left_inclusive": 0.8,
          "pr_auc": 0.05108122362869198,
          "prevalence": 0.022222222222222223,
          "right_inclusive": 1.0
        }
      ],
      "mlp_probe": [
        {
          "bin_index": 0,
          "count": 89,
          "left_inclusive": 0.0,
          "pr_auc": 0.18043009717654587,
          "prevalence": 0.19101123595505617,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 88,
          "left_inclusive": 0.2,
          "pr_auc": 0.15355674786427587,
          "prevalence": 0.14772727272727273,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 87,
          "left_inclusive": 0.4,
          "pr_auc": 0.07754107866506157,
          "prevalence": 0.09195402298850575,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 88,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.09416365178739641,
          "prevalence": 0.056818181818181816,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 90,
          "left_inclusive": 0.8,
          "pr_auc": 0.058108660130718956,
          "prevalence": 0.022222222222222223,
          "right_inclusive": 1.0
        }
      ],
      "position_baseline": [
        {
          "bin_index": 0,
          "count": 89,
          "left_inclusive": 0.0,
          "pr_auc": 0.31174585308813685,
          "prevalence": 0.19101123595505617,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 88,
          "left_inclusive": 0.2,
          "pr_auc": 0.1706799765571279,
          "prevalence": 0.14772727272727273,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 87,
          "left_inclusive": 0.4,
          "pr_auc": 0.11174913158240017,
          "prevalence": 0.09195402298850575,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 88,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.06164481933929679,
          "prevalence": 0.056818181818181816,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 90,
          "left_inclusive": 0.8,
          "pr_auc": 0.036421911421911424,
          "prevalence": 0.022222222222222223,
          "right_inclusive": 1.0
        }
      ],
      "text_only_baseline": [
        {
          "bin_index": 0,
          "count": 89,
          "left_inclusive": 0.0,
          "pr_auc": 0.14604579924697864,
          "prevalence": 0.19101123595505617,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 88,
          "left_inclusive": 0.2,
          "pr_auc": 0.14298625970874715,
          "prevalence": 0.14772727272727273,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 87,
          "left_inclusive": 0.4,
          "pr_auc": 0.08136176249755442,
          "prevalence": 0.09195402298850575,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 88,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.06116516833531523,
          "prevalence": 0.056818181818181816,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 90,
          "left_inclusive": 0.8,
          "pr_auc": 0.024362892009950832,
          "prevalence": 0.022222222222222223,
          "right_inclusive": 1.0
        }
      ]
    }
  },
  "primary_metric_name": "pr_auc",
  "residual_metrics": {
    "test": {},
    "val": {}
  },
  "residualize_against": "none",
  "rows": {
    "test": 681,
    "train": 2343,
    "val": 442
  },
  "run_name": "seed_3",
  "seed": 3,
  "splits": {
    "test": 3,
    "train": 14,
    "val": 3
  },
  "target_mode": "anchor_binary",
  "test": {
    "activations_plus_position": {
      "pr_auc": 0.13364366518922263,
      "spearman_mean": -0.01406993917591802,
      "top_10_recall": 0.03333333333333333,
      "top_5_recall": 0.0
    },
    "linear_probe": {
      "pr_auc": 0.12724785749150602,
      "spearman_mean": -0.034695833265105856,
      "top_10_recall": 0.03333333333333333,
      "top_5_recall": 0.0
    },
    "mlp_probe": {
      "pr_auc": 0.11351902799745348,
      "spearman_mean": 0.045304039651313965,
      "top_10_recall": 0.03333333333333333,
      "top_5_recall": 0.0
    },
    "position_baseline": {
      "pr_auc": 0.18918195906477828,
      "spearman_mean": 0.21547450604374666,
      "top_10_recall": 0.10000000000000002,
      "top_5_recall": 0.0
    },
    "text_only_baseline": {
      "pr_auc": 0.09981147250830939,
      "spearman_mean": -0.03665472274326531,
      "top_10_recall": 0.0,
      "top_5_recall": 0.0
    }
  },
  "tripwires": {
    "overfit_one_problem_test": {
      "can_memorize": true,
      "problem_id": 330,
      "train_pr_auc": 1.0
    },
    "random_label_test": {
      "near_chance": true,
      "test_pr_auc": 0.10738675310163437,
      "test_prevalence": 0.1027900146842878
    }
  },
  "val": {
    "activations_plus_position": {
      "pr_auc": 0.152428980519141,
      "spearman_mean": 0.07531781289997617,
      "top_10_recall": 0.10000000000000002,
      "top_5_recall": 0.0
    },
    "linear_probe": {
      "pr_auc": 0.15533865554220594,
      "spearman_mean": 0.0650009305553773,
      "top_10_recall": 0.13333333333333333,
      "top_5_recall": 0.0
    },
    "mlp_probe": {
      "pr_auc": 0.11482160268098338,
      "spearman_mean": 0.16899297963963797,
      "top_10_recall": 0.03333333333333333,
      "top_5_recall": 0.0
    },
    "position_baseline": {
      "pr_auc": 0.18871871452654682,
      "spearman_mean": 0.3210328377531009,
      "top_10_recall": 0.19999999999999998,
      "top_5_recall": 0.13333333333333333
    },
    "text_only_baseline": {
      "pr_auc": 0.09068125706035152,
      "spearman_mean": 0.0730299879895746,
      "top_10_recall": 0.03333333333333333,
      "top_5_recall": 0.0
    }
  }
}