{
  "cache_provenance": {
    "anchor_percentile": 90.0,
    "compute_dtype": "float16",
    "counterfactual_field": "counterfactual_importance_accuracy",
    "drop_last_chunk": true,
    "dtype": "float16",
    "embedding_layout": "sentence_mean",
    "layer_index": 24,
    "layer_mode": "mid",
    "model_dir": "deepseek-r1-distill-qwen-14b",
    "model_name_or_path": "deepseek-ai/DeepSeek-R1-Distill-Qwen-14B",
    "num_sentences": 2932,
    "pooling": "mean",
    "repo_id": "uzaymacar/math-rollouts",
    "requested_layer_index": null,
    "split_dir": "correct_base_solution",
    "temp_dir": "temperature_0.6_top_p_0.95",
    "total_tokens": 74486,
    "vertical_attention_depth_control": true,
    "vertical_attention_full_max_seq_len": 1024,
    "vertical_attention_light_last_n_tokens": 1,
    "vertical_attention_mode": "off"
  },
  "confidence_intervals": {
    "score_activations_plus_position_minus_score_position_baseline": {
      "ci_high": 0.022163503056178785,
      "ci_low": -0.22063107941054327,
      "delta_mean": -0.07750696142236885,
      "group_col": "problem_id",
      "n_bootstrap": 2000,
      "n_valid_bootstrap": 2000,
      "point_delta": -0.061242380282320125,
      "score_a": "score_activations_plus_position",
      "score_b": "score_position_baseline"
    },
    "score_activations_plus_position_minus_score_text_only_baseline": {
      "ci_high": 0.06517091426098723,
      "ci_low": -0.019228954294325598,
      "delta_mean": 0.023800354911244194,
      "group_col": "problem_id",
      "n_bootstrap": 2000,
      "n_valid_bootstrap": 2000,
      "point_delta": 0.022699522106865516,
      "score_a": "score_activations_plus_position",
      "score_b": "score_text_only_baseline"
    }
  },
  "has_vertical_scores": false,
  "position_bin_metrics": {
    "num_bins": 5,
    "test": {
      "activations_plus_position": [
        {
          "bin_index": 0,
          "count": 84,
          "left_inclusive": 0.0,
          "pr_auc": 0.1287262030417369,
          "prevalence": 0.17857142857142858,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 84,
          "left_inclusive": 0.2,
          "pr_auc": 0.3681284377833035,
          "prevalence": 0.20238095238095238,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 82,
          "left_inclusive": 0.4,
          "pr_auc": 0.09868432772605484,
          "prevalence": 0.07317073170731707,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 84,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.02401291420160062,
          "prevalence": 0.03571428571428571,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 84,
          "left_inclusive": 0.8,
          "pr_auc": 0.03790663992869875,
          "prevalence": 0.023809523809523808,
          "right_inclusive": 1.0
        }
      ],
      "linear_probe": [
        {
          "bin_index": 0,
          "count": 84,
          "left_inclusive": 0.0,
          "pr_auc": 0.12888975870880892,
          "prevalence": 0.17857142857142858,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 84,
          "left_inclusive": 0.2,
          "pr_auc": 0.37812248516484304,
          "prevalence": 0.20238095238095238,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 82,
          "left_inclusive": 0.4,
          "pr_auc": 0.09868432772605484,
          "prevalence": 0.07317073170731707,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 84,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.024380034759668302,
          "prevalence": 0.03571428571428571,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 84,
          "left_inclusive": 0.8,
          "pr_auc": 0.03790663992869875,
          "prevalence": 0.023809523809523808,
          "right_inclusive": 1.0
        }
      ],
      "mlp_probe": [
        {
          "bin_index": 0,
          "count": 84,
          "left_inclusive": 0.0,
          "pr_auc": 0.13377416263180678,
          "prevalence": 0.17857142857142858,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 84,
          "left_inclusive": 0.2,
          "pr_auc": 0.18262609898808774,
          "prevalence": 0.20238095238095238,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 82,
          "left_inclusive": 0.4,
          "pr_auc": 0.21043506817313154,
          "prevalence": 0.07317073170731707,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 84,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.031211294997269066,
          "prevalence": 0.03571428571428571,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 84,
          "left_inclusive": 0.8,
          "pr_auc": 0.020123070504797665,
          "prevalence": 0.023809523809523808,
          "right_inclusive": 1.0
        }
      ],
      "position_baseline": [
        {
          "bin_index": 0,
          "count": 84,
          "left_inclusive": 0.0,
          "pr_auc": 0.18940641200520494,
          "prevalence": 0.17857142857142858,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 84,
          "left_inclusive": 0.2,
          "pr_auc": 0.2416538445002382,
          "prevalence": 0.20238095238095238,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 82,
          "left_inclusive": 0.4,
          "pr_auc": 0.05374762869381797,
          "prevalence": 0.07317073170731707,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 84,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.3720847818470908,
          "prevalence": 0.03571428571428571,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 84,
          "left_inclusive": 0.8,
          "pr_auc": 0.03578533535430087,
          "prevalence": 0.023809523809523808,
          "right_inclusive": 1.0
        }
      ],
      "text_only_baseline": [
        {
          "bin_index": 0,
          "count": 84,
          "left_inclusive": 0.0,
          "pr_auc": 0.1415138749255544,
          "prevalence": 0.17857142857142858,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 84,
          "left_inclusive": 0.2,
          "pr_auc": 0.19713769581230267,
          "prevalence": 0.20238095238095238,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 82,
          "left_inclusive": 0.4,
          "pr_auc": 0.06306429482308828,
          "prevalence": 0.07317073170731707,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 84,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.023294471075688824,
          "prevalence": 0.03571428571428571,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 84,
          "left_inclusive": 0.8,
          "pr_auc": 0.025728387962430516,
          "prevalence": 0.023809523809523808,
          "right_inclusive": 1.0
        }
      ]
    },
    "val": {
      "activations_plus_position": [
        {
          "bin_index": 0,
          "count": 72,
          "left_inclusive": 0.0,
          "pr_auc": 0.23792326399662753,
          "prevalence": 0.25,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 72,
          "left_inclusive": 0.2,
          "pr_auc": 0.2556833552779079,
          "prevalence": 0.20833333333333334,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 69,
          "left_inclusive": 0.4,
          "pr_auc": 0.049517418880411807,
          "prevalence": 0.043478260869565216,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 72,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 72,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "linear_probe": [
        {
          "bin_index": 0,
          "count": 72,
          "left_inclusive": 0.0,
          "pr_auc": 0.23718258814885257,
          "prevalence": 0.25,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 72,
          "left_inclusive": 0.2,
          "pr_auc": 0.2580319365342853,
          "prevalence": 0.20833333333333334,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 69,
          "left_inclusive": 0.4,
          "pr_auc": 0.04912059348358641,
          "prevalence": 0.043478260869565216,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 72,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 72,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "mlp_probe": [
        {
          "bin_index": 0,
          "count": 72,
          "left_inclusive": 0.0,
          "pr_auc": 0.23859567411291227,
          "prevalence": 0.25,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 72,
          "left_inclusive": 0.2,
          "pr_auc": 0.33791104116844745,
          "prevalence": 0.20833333333333334,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 69,
          "left_inclusive": 0.4,
          "pr_auc": 0.02599603786044464,
          "prevalence": 0.043478260869565216,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 72,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 72,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "position_baseline": [
        {
          "bin_index": 0,
          "count": 72,
          "left_inclusive": 0.0,
          "pr_auc": 0.23118298268418902,
          "prevalence": 0.25,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 72,
          "left_inclusive": 0.2,
          "pr_auc": 0.4862795391831394,
          "prevalence": 0.20833333333333334,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 69,
          "left_inclusive": 0.4,
          "pr_auc": 0.06284699107350555,
          "prevalence": 0.043478260869565216,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 72,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 72,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "text_only_baseline": [
        {
          "bin_index": 0,
          "count": 72,
          "left_inclusive": 0.0,
          "pr_auc": 0.21054293117340675,
          "prevalence": 0.25,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 72,
          "left_inclusive": 0.2,
          "pr_auc": 0.2627772866723419,
          "prevalence": 0.20833333333333334,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 69,
          "left_inclusive": 0.4,
          "pr_auc": 0.040034869783153536,
          "prevalence": 0.043478260869565216,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 72,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 72,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ]
    }
  },
  "primary_metric_name": "pr_auc",
  "residual_metrics": {
    "test": {},
    "val": {}
  },
  "residualize_against": "none",
  "rows": {
    "test": 418,
    "train": 2157,
    "val": 357
  },
  "run_name": "seed_0",
  "seed": 0,
  "splits": {
    "test": 3,
    "train": 14,
    "val": 3
  },
  "target_mode": "anchor_binary",
  "test": {
    "activations_plus_position": {
      "pr_auc": 0.11882366105878042,
      "spearman_mean": 0.17653836547979895,
      "top_10_recall": 0.03333333333333333,
      "top_5_recall": 0.0
    },
    "linear_probe": {
      "pr_auc": 0.11867276663700471,
      "spearman_mean": 0.16981118485369726,
      "top_10_recall": 0.06666666666666667,
      "top_5_recall": 0.0
    },
    "mlp_probe": {
      "pr_auc": 0.11233514239489621,
      "spearman_mean": 0.20109778953126212,
      "top_10_recall": 0.13333333333333333,
      "top_5_recall": 0.0
    },
    "position_baseline": {
      "pr_auc": 0.18006604134110055,
      "spearman_mean": 0.4799399636476238,
      "top_10_recall": 0.06666666666666667,
      "top_5_recall": 0.06666666666666667
    },
    "text_only_baseline": {
      "pr_auc": 0.0961241389519149,
      "spearman_mean": 0.08759614492080459,
      "top_10_recall": 0.03333333333333333,
      "top_5_recall": 0.0
    }
  },
  "tripwires": {
    "overfit_one_problem_test": {
      "can_memorize": true,
      "problem_id": 330,
      "train_pr_auc": 1.0
    },
    "random_label_test": {
      "near_chance": true,
      "test_pr_auc": 0.1107294959083626,
      "test_prevalence": 0.10287081339712918
    }
  },
  "val": {
    "activations_plus_position": {
      "pr_auc": 0.16528215051452103,
      "spearman_mean": 0.37144659835007515,
      "top_10_recall": 0.2333333333333333,
      "top_5_recall": 0.13333333333333333
    },
    "linear_probe": {
      "pr_auc": 0.1644152985507514,
      "spearman_mean": 0.36525639959223694,
      "top_10_recall": 0.2333333333333333,
      "top_5_recall": 0.13333333333333333
    },
    "mlp_probe": {
      "pr_auc": 0.16947287681717188,
      "spearman_mean": 0.29450488638107014,
      "top_10_recall": 0.3,
      "top_5_recall": 0.0
    },
    "position_baseline": {
      "pr_auc": 0.2585169755295694,
      "spearman_mean": 0.6912460458321141,
      "top_10_recall": 0.26666666666666666,
      "top_5_recall": 0.06666666666666667
    },
    "text_only_baseline": {
      "pr_auc": 0.12232077586584611,
      "spearman_mean": 0.17533485005298743,
      "top_10_recall": 0.13333333333333333,
      "top_5_recall": 0.0
    }
  }
}