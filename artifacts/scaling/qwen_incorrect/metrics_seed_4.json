{
  "cache_provenance": {
    "anchor_percentile": 90.0,
    "compute_dtype": "float16",
    "counterfactual_field": "counterfactual_importance_accuracy",
    "drop_last_chunk": true,
    "dtype": "float16",
    "embedding_layout": "sentence_mean",
    "layer_index": 24,
    "layer_mode": "mid",
    "model_dir": "deepseek-r1-distill-qwen-14b",
    "model_name_or_path": "deepseek-ai/DeepSeek-R1-Distill-Qwen-14B",
    "num_sentences": 3502,
    "pooling": "mean",
    "repo_id": "uzaymacar/math-rollouts",
    "requested_layer_index": null,
    "split_dir": "incorrect_base_solution",
    "temp_dir": "temperature_0.6_top_p_0.95",
    "total_tokens": 91031,
    "vertical_attention_depth_control": true,
    "vertical_attention_full_max_seq_len": 1024,
    "vertical_attention_light_last_n_tokens": 1,
    "vertical_attention_mode": "off"
  },
  "confidence_intervals": {
    "score_activations_plus_position_minus_score_position_baseline": {
      "ci_high": 0.0294207524984266,
      "ci_low": 0.002117984906860368,
      "delta_mean": 0.011825298464294835,
      "group_col": "problem_id",
      "n_bootstrap": 2000,
      "n_valid_bootstrap": 2000,
      "point_delta": 0.014422418116490796,
      "score_a": "score_activations_plus_position",
      "score_b": "score_position_baseline"
    },
    "score_activations_plus_position_minus_score_text_only_baseline": {
      "ci_high": 0.07988146407279467,
      "ci_low": -0.030618476236557862,
      "delta_mean": 0.013375374823347,
      "group_col": "problem_id",
      "n_bootstrap": 2000,
      "n_valid_bootstrap": 2000,
      "point_delta": 0.00650240546171979,
      "score_a": "score_activations_plus_position",
      "score_b": "score_text_only_baseline"
    }
  },
  "has_vertical_scores": false,
  "position_bin_metrics": {
    "num_bins": 5,
    "test": {
      "activations_plus_position": [
        {
          "bin_index": 0,
          "count": 150,
          "left_inclusive": 0.0,
          "pr_auc": 0.0894351684957092,
          "prevalence": 0.05333333333333334,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 148,
          "left_inclusive": 0.2,
          "pr_auc": 0.3019349544038404,
          "prevalence": 0.25675675675675674,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 149,
          "left_inclusive": 0.4,
          "pr_auc": 0.129051417826883,
          "prevalence": 0.09395973154362416,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 148,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.05654279942017096,
          "prevalence": 0.06756756756756757,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 151,
          "left_inclusive": 0.8,
          "pr_auc": 0.04386069580721731,
          "prevalence": 0.046357615894039736,
          "right_inclusive": 1.0
        }
      ],
      "linear_probe": [
        {
          "bin_index": 0,
          "count": 150,
          "left_inclusive": 0.0,
          "pr_auc": 0.08991644933242912,
          "prevalence": 0.05333333333333334,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 148,
          "left_inclusive": 0.2,
          "pr_auc": 0.3019661472207533,
          "prevalence": 0.25675675675675674,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 149,
          "left_inclusive": 0.4,
          "pr_auc": 0.12997795499296352,
          "prevalence": 0.09395973154362416,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 148,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.05605494037104801,
          "prevalence": 0.06756756756756757,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 151,
          "left_inclusive": 0.8,
          "pr_auc": 0.043744745716654425,
          "prevalence": 0.046357615894039736,
          "right_inclusive": 1.0
        }
      ],
      "mlp_probe": [
        {
          "bin_index": 0,
          "count": 150,
          "left_inclusive": 0.0,
          "pr_auc": 0.17869317691769165,
          "prevalence": 0.05333333333333334,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 148,
          "left_inclusive": 0.2,
          "pr_auc": 0.3133650535963306,
          "prevalence": 0.25675675675675674,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 149,
          "left_inclusive": 0.4,
          "pr_auc": 0.1294748762339346,
          "prevalence": 0.09395973154362416,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 148,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.07421871774633115,
          "prevalence": 0.06756756756756757,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 151,
          "left_inclusive": 0.8,
          "pr_auc": 0.23745451156293956,
          "prevalence": 0.046357615894039736,
          "right_inclusive": 1.0
        }
      ],
      "position_baseline": [
        {
          "bin_index": 0,
          "count": 150,
          "left_inclusive": 0.0,
          "pr_auc": 0.040406668425907136,
          "prevalence": 0.05333333333333334,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 148,
          "left_inclusive": 0.2,
          "pr_auc": 0.24953345711928648,
          "prevalence": 0.25675675675675674,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 149,
          "left_inclusive": 0.4,
          "pr_auc": 0.12576055397519648,
          "prevalence": 0.09395973154362416,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 148,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.1066487146740307,
          "prevalence": 0.06756756756756757,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 151,
          "left_inclusive": 0.8,
          "pr_auc": 0.03481881860724488,
          "prevalence": 0.046357615894039736,
          "right_inclusive": 1.0
        }
      ],
      "text_only_baseline": [
        {
          "bin_index": 0,
          "count": 150,
          "left_inclusive": 0.0,
          "pr_auc": 0.08255919523928859,
          "prevalence": 0.05333333333333334,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 148,
          "left_inclusive": 0.2,
          "pr_auc": 0.2641997120159718,
          "prevalence": 0.25675675675675674,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 149,
          "left_inclusive": 0.4,
          "pr_auc": 0.10988881749699383,
          "prevalence": 0.09395973154362416,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 148,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.11034722206538607,
          "prevalence": 0.06756756756756757,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 151,
          "left_inclusive": 0.8,
          "pr_auc": 0.06608709047561316,
          "prevalence": 0.046357615894039736,
          "right_inclusive": 1.0
        }
      ]
    },
    "val": {
      "activations_plus_position": [
        {
          "bin_index": 0,
          "count": 81,
          "left_inclusive": 0.0,
          "pr_auc": 0.1361024844720497,
          "prevalence": 0.06172839506172839,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 80,
          "left_inclusive": 0.2,
          "pr_auc": 0.20121343397112662,
          "prevalence": 0.1625,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 81,
          "left_inclusive": 0.4,
          "pr_auc": 0.07607323858142326,
          "prevalence": 0.09876543209876543,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 80,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.0941610355314635,
          "prevalence": 0.125,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 81,
          "left_inclusive": 0.8,
          "pr_auc": 0.04672453909960694,
          "prevalence": 0.06172839506172839,
          "right_inclusive": 1.0
        }
      ],
      "linear_probe": [
        {
          "bin_index": 0,
          "count": 81,
          "left_inclusive": 0.0,
          "pr_auc": 0.28610248447204967,
          "prevalence": 0.06172839506172839,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 80,
          "left_inclusive": 0.2,
          "pr_auc": 0.20190070861202114,
          "prevalence": 0.1625,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 81,
          "left_inclusive": 0.4,
          "pr_auc": 0.07602634537046755,
          "prevalence": 0.09876543209876543,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 80,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.09374173319514435,
          "prevalence": 0.125,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 81,
          "left_inclusive": 0.8,
          "pr_auc": 0.04690795845632697,
          "prevalence": 0.06172839506172839,
          "right_inclusive": 1.0
        }
      ],
      "mlp_probe": [
        {
          "bin_index": 0,
          "count": 81,
          "left_inclusive": 0.0,
          "pr_auc": 0.06263875332804388,
          "prevalence": 0.06172839506172839,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 80,
          "left_inclusive": 0.2,
          "pr_auc": 0.1718777850838201,
          "prevalence": 0.1625,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 81,
          "left_inclusive": 0.4,
          "pr_auc": 0.08992940482507213,
          "prevalence": 0.09876543209876543,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 80,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.12518687049379473,
          "prevalence": 0.125,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 81,
          "left_inclusive": 0.8,
          "pr_auc": 0.04989619952330379,
          "prevalence": 0.06172839506172839,
          "right_inclusive": 1.0
        }
      ],
      "position_baseline": [
        {
          "bin_index": 0,
          "count": 81,
          "left_inclusive": 0.0,
          "pr_auc": 0.05279398212062014,
          "prevalence": 0.06172839506172839,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 80,
          "left_inclusive": 0.2,
          "pr_auc": 0.18496420863430635,
          "prevalence": 0.1625,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 81,
          "left_inclusive": 0.4,
          "pr_auc": 0.12008160848258653,
          "prevalence": 0.09876543209876543,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 80,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.17025591474375446,
          "prevalence": 0.125,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 81,
          "left_inclusive": 0.8,
          "pr_auc": 0.058665346106917086,
          "prevalence": 0.06172839506172839,
          "right_inclusive": 1.0
        }
      ],
      "text_only_baseline": [
        {
          "bin_index": 0,
          "count": 81,
          "left_inclusive": 0.0,
          "pr_auc": 0.23867853174208578,
          "prevalence": 0.06172839506172839,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 80,
          "left_inclusive": 0.2,
          "pr_auc": 0.13819764624806036,
          "prevalence": 0.1625,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 81,
          "left_inclusive": 0.4,
          "pr_auc": 0.1578751426264703,
          "prevalence": 0.09876543209876543,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 80,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.11630083320086705,
          "prevalence": 0.125,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 81,
          "left_inclusive": 0.8,
          "pr_auc": 0.06202370586848648,
          "prevalence": 0.06172839506172839,
          "right_inclusive": 1.0
        }
      ]
    }
  },
  "primary_metric_name": "pr_auc",
  "residual_metrics": {
    "test": {},
    "val": {}
  },
  "residualize_against": "none",
  "rows": {
    "test": 746,
    "train": 2353,
    "val": 403
  },
  "run_name": "seed_4",
  "seed": 4,
  "splits": {
    "test": 3,
    "train": 14,
    "val": 3
  },
  "target_mode": "anchor_binary",
  "test": {
    "activations_plus_position": {
      "pr_auc": 0.1250915729980186,
      "spearman_mean": 0.06033818865754092,
      "top_10_recall": 0.09999999999999999,
      "top_5_recall": 0.0
    },
    "linear_probe": {
      "pr_auc": 0.12497421169529138,
      "spearman_mean": 0.058311783553927736,
      "top_10_recall": 0.09999999999999999,
      "top_5_recall": 0.0
    },
    "mlp_probe": {
      "pr_auc": 0.13832385678658524,
      "spearman_mean": 0.21419625585353,
      "top_10_recall": 0.06666666666666667,
      "top_5_recall": 0.0
    },
    "position_baseline": {
      "pr_auc": 0.1106691548815278,
      "spearman_mean": 0.13788948410208074,
      "top_10_recall": 0.03333333333333333,
      "top_5_recall": 0.0
    },
    "text_only_baseline": {
      "pr_auc": 0.1185891675362988,
      "spearman_mean": 0.0959958814474305,
      "top_10_recall": 0.03333333333333333,
      "top_5_recall": 0.0
    }
  },
  "tripwires": {
    "overfit_one_problem_test": {
      "can_memorize": false,
      "problem_id": 330,
      "train_pr_auc": 0.7623967425332716
    },
    "random_label_test": {
      "near_chance": true,
      "test_pr_auc": 0.10307322164089315,
      "test_prevalence": 0.1032171581769437
    }
  },
  "val": {
    "activations_plus_position": {
      "pr_auc": 0.09987704176461486,
      "spearman_mean": -0.08634759093247668,
      "top_10_recall": 0.06666666666666667,
      "top_5_recall": 0.06666666666666667
    },
    "linear_probe": {
      "pr_auc": 0.10018464912692875,
      "spearman_mean": -0.0870511664260974,
      "top_10_recall": 0.06666666666666667,
      "top_5_recall": 0.06666666666666667
    },
    "mlp_probe": {
      "pr_auc": 0.09655401973408359,
      "spearman_mean": 0.006755321411299674,
      "top_10_recall": 0.03333333333333333,
      "top_5_recall": 0.06666666666666667
    },
    "position_baseline": {
      "pr_auc": 0.10011992194616184,
      "spearman_mean": 0.18867591704881795,
      "top_10_recall": 0.06666666666666667,
      "top_5_recall": 0.06666666666666667
    },
    "text_only_baseline": {
      "pr_auc": 0.11530437635514276,
      "spearman_mean": -0.08814702766370623,
      "top_10_recall": 0.10000000000000002,
      "top_5_recall": 0.06666666666666667
    }
  }
}