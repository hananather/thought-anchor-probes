{
  "cache_provenance": {
    "anchor_percentile": 90.0,
    "compute_dtype": "float16",
    "counterfactual_field": "counterfactual_importance_accuracy",
    "drop_last_chunk": true,
    "dtype": "float32",
    "embedding_layout": "sentence_mean",
    "layer_index": 16,
    "layer_mode": "mid",
    "model_dir": "deepseek-r1-distill-llama-8b",
    "model_name_or_path": "deepseek-ai/DeepSeek-R1-Distill-Llama-8B",
    "num_sentences": 3983,
    "pooling": "mean",
    "repo_id": "uzaymacar/math-rollouts",
    "requested_layer_index": null,
    "split_dir": "correct_base_solution",
    "temp_dir": "temperature_0.6_top_p_0.95",
    "total_tokens": 88587,
    "vertical_attention_depth_control": true,
    "vertical_attention_full_max_seq_len": 1024,
    "vertical_attention_light_last_n_tokens": 1,
    "vertical_attention_mode": "off"
  },
  "confidence_intervals": {
    "score_activations_plus_position_minus_score_position_baseline": {
      "ci_high": 0.06962292008297322,
      "ci_low": -0.03449654540621369,
      "delta_mean": 0.00682960079970681,
      "group_col": "problem_id",
      "n_bootstrap": 1000,
      "n_valid_bootstrap": 1000,
      "point_delta": 0.005151858620169841,
      "score_a": "score_activations_plus_position",
      "score_b": "score_position_baseline"
    },
    "score_activations_plus_position_minus_score_text_only_baseline": {
      "ci_high": 0.10935945986365299,
      "ci_low": -0.001628010537816943,
      "delta_mean": 0.0637751549132083,
      "group_col": "problem_id",
      "n_bootstrap": 1000,
      "n_valid_bootstrap": 1000,
      "point_delta": 0.06528538865509492,
      "score_a": "score_activations_plus_position",
      "score_b": "score_text_only_baseline"
    }
  },
  "has_vertical_scores": false,
  "position_bin_metrics": {
    "num_bins": 5,
    "test": {
      "activations_plus_position": [
        {
          "bin_index": 0,
          "count": 137,
          "left_inclusive": 0.0,
          "pr_auc": 0.11985432510908256,
          "prevalence": 0.13138686131386862,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 137,
          "left_inclusive": 0.2,
          "pr_auc": 0.38658003704930066,
          "prevalence": 0.23357664233576642,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 136,
          "left_inclusive": 0.4,
          "pr_auc": 0.1317039272190982,
          "prevalence": 0.11764705882352941,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 137,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.014686537669210936,
          "prevalence": 0.021897810218978103,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 137,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "linear_probe": [
        {
          "bin_index": 0,
          "count": 137,
          "left_inclusive": 0.0,
          "pr_auc": 0.11948195100641418,
          "prevalence": 0.13138686131386862,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 137,
          "left_inclusive": 0.2,
          "pr_auc": 0.39196169501831984,
          "prevalence": 0.23357664233576642,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 136,
          "left_inclusive": 0.4,
          "pr_auc": 0.13166287680243838,
          "prevalence": 0.11764705882352941,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 137,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.014967811378200316,
          "prevalence": 0.021897810218978103,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 137,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "mlp_probe": [
        {
          "bin_index": 0,
          "count": 137,
          "left_inclusive": 0.0,
          "pr_auc": 0.1589312124750608,
          "prevalence": 0.13138686131386862,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 137,
          "left_inclusive": 0.2,
          "pr_auc": 0.39261046170833247,
          "prevalence": 0.23357664233576642,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 136,
          "left_inclusive": 0.4,
          "pr_auc": 0.14936883232388376,
          "prevalence": 0.11764705882352941,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 137,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.017970211740610222,
          "prevalence": 0.021897810218978103,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 137,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "position_baseline": [
        {
          "bin_index": 0,
          "count": 137,
          "left_inclusive": 0.0,
          "pr_auc": 0.1286353333814416,
          "prevalence": 0.13138686131386862,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 137,
          "left_inclusive": 0.2,
          "pr_auc": 0.2902699141818057,
          "prevalence": 0.23357664233576642,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 136,
          "left_inclusive": 0.4,
          "pr_auc": 0.1341898698915443,
          "prevalence": 0.11764705882352941,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 137,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.04581292087428562,
          "prevalence": 0.021897810218978103,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 137,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "text_only_baseline": [
        {
          "bin_index": 0,
          "count": 137,
          "left_inclusive": 0.0,
          "pr_auc": 0.12523815917046385,
          "prevalence": 0.13138686131386862,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 137,
          "left_inclusive": 0.2,
          "pr_auc": 0.2611543068994533,
          "prevalence": 0.23357664233576642,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 136,
          "left_inclusive": 0.4,
          "pr_auc": 0.16729688417505267,
          "prevalence": 0.11764705882352941,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 137,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.012242263070655806,
          "prevalence": 0.021897810218978103,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 137,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ]
    },
    "val": {
      "activations_plus_position": [
        {
          "bin_index": 0,
          "count": 113,
          "left_inclusive": 0.0,
          "pr_auc": 0.25491182120126854,
          "prevalence": 0.17699115044247787,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 113,
          "left_inclusive": 0.2,
          "pr_auc": 0.22950234078988524,
          "prevalence": 0.09734513274336283,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 110,
          "left_inclusive": 0.4,
          "pr_auc": 0.18063350662872682,
          "prevalence": 0.16363636363636364,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 113,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.08996553719965428,
          "prevalence": 0.07964601769911504,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 113,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "linear_probe": [
        {
          "bin_index": 0,
          "count": 113,
          "left_inclusive": 0.0,
          "pr_auc": 0.2629822682715567,
          "prevalence": 0.17699115044247787,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 113,
          "left_inclusive": 0.2,
          "pr_auc": 0.21554598803684558,
          "prevalence": 0.09734513274336283,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 110,
          "left_inclusive": 0.4,
          "pr_auc": 0.18638389249069987,
          "prevalence": 0.16363636363636364,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 113,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.08702988692793057,
          "prevalence": 0.07964601769911504,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 113,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "mlp_probe": [
        {
          "bin_index": 0,
          "count": 113,
          "left_inclusive": 0.0,
          "pr_auc": 0.3428055628580779,
          "prevalence": 0.17699115044247787,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 113,
          "left_inclusive": 0.2,
          "pr_auc": 0.10990685429539913,
          "prevalence": 0.09734513274336283,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 110,
          "left_inclusive": 0.4,
          "pr_auc": 0.2557300790604205,
          "prevalence": 0.16363636363636364,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 113,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.2173358036537234,
          "prevalence": 0.07964601769911504,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 113,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "position_baseline": [
        {
          "bin_index": 0,
          "count": 113,
          "left_inclusive": 0.0,
          "pr_auc": 0.2755851579447218,
          "prevalence": 0.17699115044247787,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 113,
          "left_inclusive": 0.2,
          "pr_auc": 0.06412515545874212,
          "prevalence": 0.09734513274336283,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 110,
          "left_inclusive": 0.4,
          "pr_auc": 0.30400699069043613,
          "prevalence": 0.16363636363636364,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 113,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.1785359770887249,
          "prevalence": 0.07964601769911504,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 113,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "text_only_baseline": [
        {
          "bin_index": 0,
          "count": 113,
          "left_inclusive": 0.0,
          "pr_auc": 0.31233272770839293,
          "prevalence": 0.17699115044247787,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 113,
          "left_inclusive": 0.2,
          "pr_auc": 0.13965002303465676,
          "prevalence": 0.09734513274336283,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 110,
          "left_inclusive": 0.4,
          "pr_auc": 0.1323013547496087,
          "prevalence": 0.16363636363636364,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 113,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": 0.31822531984672336,
          "prevalence": 0.07964601769911504,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 113,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ]
    }
  },
  "primary_metric_name": "pr_auc",
  "residual_metrics": {
    "test": {},
    "val": {}
  },
  "residualize_against": "none",
  "rows": {
    "test": 684,
    "train": 2737,
    "val": 562
  },
  "run_name": "seed_2",
  "seed": 2,
  "splits": {
    "test": 3,
    "train": 14,
    "val": 3
  },
  "target_mode": "anchor_binary",
  "test": {
    "activations_plus_position": {
      "pr_auc": 0.16761843984346572,
      "spearman_mean": 0.2244897917046517,
      "top_10_recall": 0.13333333333333333,
      "top_5_recall": 0.06666666666666667
    },
    "linear_probe": {
      "pr_auc": 0.16798607179583788,
      "spearman_mean": 0.22483730321443315,
      "top_10_recall": 0.16666666666666666,
      "top_5_recall": 0.06666666666666667
    },
    "mlp_probe": {
      "pr_auc": 0.19403255486099166,
      "spearman_mean": 0.31877304520461863,
      "top_10_recall": 0.10000000000000002,
      "top_5_recall": 0.06666666666666667
    },
    "position_baseline": {
      "pr_auc": 0.16246658122329588,
      "spearman_mean": 0.5124960874882111,
      "top_10_recall": 0.10000000000000002,
      "top_5_recall": 0.06666666666666667
    },
    "text_only_baseline": {
      "pr_auc": 0.1023330511883708,
      "spearman_mean": -0.01281312587369727,
      "top_10_recall": 0.06666666666666667,
      "top_5_recall": 0.06666666666666667
    }
  },
  "tripwires": {
    "overfit_one_problem_test": {
      "can_memorize": true,
      "problem_id": 330,
      "train_pr_auc": 0.945015570241236
    },
    "random_label_test": {
      "near_chance": true,
      "test_pr_auc": 0.10132049808641015,
      "test_prevalence": 0.10087719298245613
    }
  },
  "val": {
    "activations_plus_position": {
      "pr_auc": 0.1580678544227004,
      "spearman_mean": 0.17131995752750853,
      "top_10_recall": 0.20000000000000004,
      "top_5_recall": 0.20000000000000004
    },
    "linear_probe": {
      "pr_auc": 0.15765888505134631,
      "spearman_mean": 0.17103500248912792,
      "top_10_recall": 0.2333333333333333,
      "top_5_recall": 0.20000000000000004
    },
    "mlp_probe": {
      "pr_auc": 0.21703175472807212,
      "spearman_mean": 0.2205803935218702,
      "top_10_recall": 0.2333333333333333,
      "top_5_recall": 0.13333333333333333
    },
    "position_baseline": {
      "pr_auc": 0.18097102192450107,
      "spearman_mean": 0.46826332383372415,
      "top_10_recall": 0.26666666666666666,
      "top_5_recall": 0.13333333333333333
    },
    "text_only_baseline": {
      "pr_auc": 0.14833941640895362,
      "spearman_mean": 0.1134714244578644,
      "top_10_recall": 0.06666666666666667,
      "top_5_recall": 0.06666666666666667
    }
  }
}