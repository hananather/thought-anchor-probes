{
  "cache_provenance": {
    "anchor_percentile": 90.0,
    "compute_dtype": "float16",
    "counterfactual_field": "counterfactual_importance_accuracy",
    "drop_last_chunk": true,
    "dtype": "float32",
    "embedding_layout": "sentence_mean",
    "layer_index": 16,
    "layer_mode": "mid",
    "model_dir": "deepseek-r1-distill-llama-8b",
    "model_name_or_path": "deepseek-ai/DeepSeek-R1-Distill-Llama-8B",
    "num_sentences": 1152,
    "pooling": "mean",
    "repo_id": "uzaymacar/math-rollouts",
    "requested_layer_index": null,
    "split_dir": "correct_base_solution",
    "temp_dir": "temperature_0.6_top_p_0.95",
    "total_tokens": 27526,
    "vertical_attention_depth_control": true,
    "vertical_attention_full_max_seq_len": 1024,
    "vertical_attention_light_last_n_tokens": 1,
    "vertical_attention_mode": "off"
  },
  "confidence_intervals": {
    "score_activations_plus_position_minus_score_position_baseline": {
      "ci_high": 0.003539182740418756,
      "ci_low": 0.003539182740418756,
      "delta_mean": 0.003539182740418756,
      "group_col": "problem_id",
      "n_bootstrap": 1000,
      "n_valid_bootstrap": 1000,
      "point_delta": 0.003539182740418756,
      "score_a": "score_activations_plus_position",
      "score_b": "score_position_baseline"
    },
    "score_activations_plus_position_minus_score_text_only_baseline": {
      "ci_high": 0.04955783958268278,
      "ci_low": 0.04955783958268278,
      "delta_mean": 0.04955783958268279,
      "group_col": "problem_id",
      "n_bootstrap": 1000,
      "n_valid_bootstrap": 1000,
      "point_delta": 0.04955783958268278,
      "score_a": "score_activations_plus_position",
      "score_b": "score_text_only_baseline"
    }
  },
  "has_vertical_scores": false,
  "position_bin_metrics": {
    "num_bins": 5,
    "test": {
      "activations_plus_position": [
        {
          "bin_index": 0,
          "count": 58,
          "left_inclusive": 0.0,
          "pr_auc": 0.23950097272976079,
          "prevalence": 0.10344827586206896,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 58,
          "left_inclusive": 0.2,
          "pr_auc": 0.18466652743911083,
          "prevalence": 0.1896551724137931,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 57,
          "left_inclusive": 0.4,
          "pr_auc": 0.30857319784596476,
          "prevalence": 0.21052631578947367,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 58,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 58,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "linear_probe": [
        {
          "bin_index": 0,
          "count": 58,
          "left_inclusive": 0.0,
          "pr_auc": 0.24008875142674072,
          "prevalence": 0.10344827586206896,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 58,
          "left_inclusive": 0.2,
          "pr_auc": 0.1990078015938065,
          "prevalence": 0.1896551724137931,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 57,
          "left_inclusive": 0.4,
          "pr_auc": 0.305853361478181,
          "prevalence": 0.21052631578947367,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 58,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 58,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "mlp_probe": [
        {
          "bin_index": 0,
          "count": 58,
          "left_inclusive": 0.0,
          "pr_auc": 0.12075687480771025,
          "prevalence": 0.10344827586206896,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 58,
          "left_inclusive": 0.2,
          "pr_auc": 0.29548930747774727,
          "prevalence": 0.1896551724137931,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 57,
          "left_inclusive": 0.4,
          "pr_auc": 0.2600596499790308,
          "prevalence": 0.21052631578947367,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 58,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 58,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "position_baseline": [
        {
          "bin_index": 0,
          "count": 58,
          "left_inclusive": 0.0,
          "pr_auc": 0.11877023834792644,
          "prevalence": 0.10344827586206896,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 58,
          "left_inclusive": 0.2,
          "pr_auc": 0.2021566894588095,
          "prevalence": 0.1896551724137931,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 57,
          "left_inclusive": 0.4,
          "pr_auc": 0.2046748216517579,
          "prevalence": 0.21052631578947367,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 58,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 58,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "text_only_baseline": [
        {
          "bin_index": 0,
          "count": 58,
          "left_inclusive": 0.0,
          "pr_auc": 0.12670454545454546,
          "prevalence": 0.10344827586206896,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 58,
          "left_inclusive": 0.2,
          "pr_auc": 0.1362407682949005,
          "prevalence": 0.1896551724137931,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 57,
          "left_inclusive": 0.4,
          "pr_auc": 0.2409227649264402,
          "prevalence": 0.21052631578947367,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 58,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 58,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ]
    },
    "val": {
      "activations_plus_position": [
        {
          "bin_index": 0,
          "count": 15,
          "left_inclusive": 0.0,
          "pr_auc": 0.26335331335331336,
          "prevalence": 0.3333333333333333,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 15,
          "left_inclusive": 0.2,
          "pr_auc": 0.12445054945054945,
          "prevalence": 0.2,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 14,
          "left_inclusive": 0.4,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 15,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 15,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "linear_probe": [
        {
          "bin_index": 0,
          "count": 15,
          "left_inclusive": 0.0,
          "pr_auc": 0.26335331335331336,
          "prevalence": 0.3333333333333333,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 15,
          "left_inclusive": 0.2,
          "pr_auc": 0.12445054945054945,
          "prevalence": 0.2,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 14,
          "left_inclusive": 0.4,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 15,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 15,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "mlp_probe": [
        {
          "bin_index": 0,
          "count": 15,
          "left_inclusive": 0.0,
          "pr_auc": 0.30256327006327005,
          "prevalence": 0.3333333333333333,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 15,
          "left_inclusive": 0.2,
          "pr_auc": 0.12155067155067155,
          "prevalence": 0.2,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 14,
          "left_inclusive": 0.4,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 15,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 15,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "position_baseline": [
        {
          "bin_index": 0,
          "count": 15,
          "left_inclusive": 0.0,
          "pr_auc": 0.40798534798534797,
          "prevalence": 0.3333333333333333,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 15,
          "left_inclusive": 0.2,
          "pr_auc": 0.12388167388167388,
          "prevalence": 0.2,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 14,
          "left_inclusive": 0.4,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 15,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 15,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ],
      "text_only_baseline": [
        {
          "bin_index": 0,
          "count": 15,
          "left_inclusive": 0.0,
          "pr_auc": 0.2963403263403263,
          "prevalence": 0.3333333333333333,
          "right_inclusive": 0.2
        },
        {
          "bin_index": 1,
          "count": 15,
          "left_inclusive": 0.2,
          "pr_auc": 0.180006105006105,
          "prevalence": 0.2,
          "right_inclusive": 0.4
        },
        {
          "bin_index": 2,
          "count": 14,
          "left_inclusive": 0.4,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.6000000000000001
        },
        {
          "bin_index": 3,
          "count": 15,
          "left_inclusive": 0.6000000000000001,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 0.8
        },
        {
          "bin_index": 4,
          "count": 15,
          "left_inclusive": 0.8,
          "pr_auc": NaN,
          "prevalence": 0.0,
          "right_inclusive": 1.0
        }
      ]
    }
  },
  "primary_metric_name": "pr_auc",
  "residual_metrics": {
    "test": {},
    "val": {}
  },
  "residualize_against": "none",
  "rows": {
    "test": 289,
    "train": 789,
    "val": 74
  },
  "run_name": "seed_2",
  "seed": 2,
  "splits": {
    "test": 1,
    "train": 3,
    "val": 1
  },
  "target_mode": "anchor_binary",
  "test": {
    "activations_plus_position": {
      "pr_auc": 0.14503334175908994,
      "spearman_mean": 0.13048728239968288,
      "top_10_recall": 0.0,
      "top_5_recall": 0.0
    },
    "linear_probe": {
      "pr_auc": 0.14763183398707863,
      "spearman_mean": 0.13465192967764447,
      "top_10_recall": 0.0,
      "top_5_recall": 0.0
    },
    "mlp_probe": {
      "pr_auc": 0.18487532161948567,
      "spearman_mean": 0.21251673666194582,
      "top_10_recall": 0.2,
      "top_5_recall": 0.2
    },
    "position_baseline": {
      "pr_auc": 0.14149415901867118,
      "spearman_mean": 0.4686187991184606,
      "top_10_recall": 0.1,
      "top_5_recall": 0.0
    },
    "text_only_baseline": {
      "pr_auc": 0.09547550217640716,
      "spearman_mean": -0.027413774023201276,
      "top_10_recall": 0.0,
      "top_5_recall": 0.0
    }
  },
  "tripwires": {
    "overfit_one_problem_test": {
      "can_memorize": false,
      "problem_id": 1591,
      "train_pr_auc": 0.8438792335115864
    },
    "random_label_test": {
      "near_chance": true,
      "test_pr_auc": 0.09680562734490639,
      "test_prevalence": 0.10034602076124567
    }
  },
  "val": {
    "activations_plus_position": {
      "pr_auc": 0.10385269180822743,
      "spearman_mean": 0.1982619789221929,
      "top_10_recall": 0.0,
      "top_5_recall": 0.0
    },
    "linear_probe": {
      "pr_auc": 0.10275438799857768,
      "spearman_mean": 0.19582505919754892,
      "top_10_recall": 0.0,
      "top_5_recall": 0.0
    },
    "mlp_probe": {
      "pr_auc": 0.12242100501081651,
      "spearman_mean": 0.13240059219191458,
      "top_10_recall": 0.1,
      "top_5_recall": 0.0
    },
    "position_baseline": {
      "pr_auc": 0.27584760897645555,
      "spearman_mean": 0.6479785686369529,
      "top_10_recall": 0.4,
      "top_5_recall": 0.2
    },
    "text_only_baseline": {
      "pr_auc": 0.0824466741189243,
      "spearman_mean": -0.14688619771840095,
      "top_10_recall": 0.1,
      "top_5_recall": 0.0
    }
  }
}